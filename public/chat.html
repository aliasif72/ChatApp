<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chat App</title>
  <link rel="stylesheet" href="chat.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
</head>

<body>
  <div class="form-modal">
    <div class="header">
      <header>
        <p class="chat">Chat App</p>
      </header>
    </div>
    <!-- <button type="button" class="btn" onclick="oldMsg(event)">Old Message</button>
    <button type="button" onclick="nextMsg(event)">New Message</button> -->
    <div class="gpbox">
      <div class="searchdiv">
      <input type="search" id="search" class="searchbox">
      <button type="button" class="searchbtn" onclick="openForm(event)"><i class="fas fa-user"></i></button>
      <button type="button" class="searchbtn" onclick="doSearch(event)"><i class="fas fa-search"></i></button>
        
    </div>


    <div class="form-popup" id="myForm">
      <form onsubmit="addGrp(event)" class="form-container">

    
        <label for="text"><b>Create Group</b></label><br><br>
        <input type="text" placeholder="Enter Group Name" id="grpName" required>
    
        <button type="submit" class="btn">Create</button>
        <button type="button" class="searchbtncross" id="close" onclick="closeForm()"><i class="fas fa-times"></i></button>
      </form>
    </div>
    
    <div id="tiles" class="tiles">
      <button type="button" class="tilebtn">Group name</button>
    </div>
    </div>
    <fieldset id="msgs">
      <p class="join">Vaibhav joined</p>
      <p class="chatbox">Vaibhav: Hello!!</p>
      <p class="chatbox" >Vaibhav: Whats up??</p>
    </fieldset>
    <div>
      <form onsubmit="saveMsg(event)">
        <input type="text" class="input" id="msg" >
        <button type="submit" class="btn">Send</button>
      </form>
    </div>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.4.0/axios.min.js"></script>
  <script>

    const parentNode = document.getElementById('msgs');

    const tileNode = document.getElementById('tiles');
    

    //REFRESH WINDOW OR REFRESH DATA EVERY SECOND
    window.addEventListener("DOMContentLoaded", async function lsLoad() {
      if (!localStorage.getItem('chat')) {
        await latestMsg();
      }
      if (!localStorage.getItem('grpname')) {
        await getGrp();
      }
      const groups=JSON.parse(localStorage.getItem('grpname'));
      const chatMsg = JSON.parse(localStorage.getItem('chat'));
      parentNode.innerHTML = ' ';
      tileNode.innerHTML=' ';
      for (let i = 0; i < chatMsg.length; i++) {
        await showMsg(chatMsg[i]);
        parentNode.scrollTop = parentNode.scrollHeight;
      }
      for(let i=0;i<groups.length;i++)
      {
        showGroup(groups[i]);
      }
    })
    
    function openForm() {
  document.getElementById("myForm").style.display = "block";
}

function closeForm() {
  document.getElementById("myForm").style.display = "none";
}

  </script>
  <script src="new.js"></script>
</body>

</html>